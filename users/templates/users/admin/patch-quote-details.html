{% extends "users/admin/base.html" %}
{% block content %}
<h2 class="mt-3">Patch Quote Details</h2>
<div class="card mt-3">
  <div class="card-body">
    <p><strong>Customer:</strong> {{ quote.user.get_full_name }}</p>
    <p><strong>Design Name:</strong> {{ quote.name }}</p>
    <p><strong>Status:</strong> {{ quote.quote_status }}</p>
    <p><strong>Created At:</strong> {{ quote.created_at|date:"M d, Y h:i A" }}</p>
    <p><strong>Files:</strong> {{ files.count }}</p>
    <ul>
      {% for file in files %}
        <li><a href="{{ file.file.url }}" target="_blank">{{ file.file.name }}</a></li>
      {% empty %}
        <li>No files uploaded.</li>
      {% endfor %}
    </ul>
  </div>
</div>

{% if can_finalize %}
<div class="mt-3">
  <form method="post">{% csrf_token %}
    <input type="hidden" name="action" value="finalize">
    <div class="mb-2">
      <label for="price">Set Price</label>
      <input type="number" step="0.01" name="price" id="price" class="form-control" required>
    </div>
    <div class="mb-2 form-check">
      <input type="checkbox" class="form-check-input" name="send_email" id="send_email" value="1" checked>
      <label for="send_email">Send email to customer</label>
    </div>
    <div class="mb-2">
      <label for="admin_message">Message (optional)</label>
      <textarea name="admin_message" class="form-control" rows="3"></textarea>
    </div>
    <button type="submit" class="btn btn-primary">Finalize Quote</button>
  </form>
</div>
{% endif %}
{% endblock %}
